[toc]



# Web基础


## D四章 连接管理

1. 客户端一条http连接的生命周期
![]()

2. 一条TCP连接由4个值唯一确定``` ```，两条TCP连接中可能3个值都一样，但是不能4个值都一样(如果四个值都一样，那就是同一条TCP连接)。如：	
	1. 有些连接共享相同的(目的ip + 目的port)(如：多个client访问同一个http server )，底层是通过什么方式实现的？？？获取同一份数据空间的地址？？
	2. 有些使用相同的源ip，
![]()



### 对TCP连接的性能优化
HTTP紧挨着TCP，位于其上层，所以HTTP事务的性能在很大程度上取决于底层TCP通道的性能。本节重点介绍了一些很重要的、对这些TCP连接的性能考虑

#### HTTP事务的时延

#### TCP连接建立握手时延

#### TCP慢启动拥塞控制

- 慢启动问题 -> 已调谐的比新建立的连接的分组发送速度快一些(严格说已调谢的tcp连接发送速度是最适合此时网络质量的) -> HTTP"持久化"连接(HTTP/1.1已经默认了)

#### Nagle算法 与 TCP_NODELAY

#### TIME_WAIT累积 与 端口耗尽


#### HTTP串行加载时延的解决方案
- HTTP串行加载是什么
	- 比如，假设有一个包含了3个嵌入图片的Web页面。浏览器需要发起4个HTTP事务来显示此页面：1个用于顶层的HTML页面，3个用于嵌入的图片。如果每个事务都需要（串行地建立）一条新的连接，那么连接时延和慢启动时延就会叠加起来

- 串行加载的缺点	
	1. 引入实际串行时延
		- 如果每个事务都需要（串行地建立）一条新的连接，那么连接时延和慢启动时延就会叠加起来，
	2. 有些浏览器在对象加载完毕之前无法获知对象的尺寸，而且它们可能需要尺寸信息来决定将对象放在屏幕的什么位置上，所以在加载了足够多的对象之前，无法在屏幕上显示任何内容。在这种情况下，可能浏览器串行装载对象的进度很正常，但用户面对的却是一个空白的屏幕，对装载的进度一无所知。
	3. 加载一幅图片时，页面上其他地方都没有动静也会让人觉得速度很慢。用户更希望能够同时加载多幅图片

- 串行加载缺点的解决方案
	1. 并行连接
		- 通过多条TCP连接发起并发的HTTP请求。(真并行)
	2. 持久连接
		- 重用TCP连接，以消除连接及关闭时延。
		- 优点
			1. 降低了时延和连接建立的开销
			2. 新连接的慢启动过程 -> 连接保持在已调谐状态
		- 缺点
			1. 易出现大量的空闲连接，耗费本地客户端及远程server上的资源
		- 持久连接&&并行连接配合使用可能是最好的方式
	3. 管道化连接
		- 通过共享的一条TCP连接发起并发的HTTP请求。(宏观并发、微观时间片轮转)
	4. 复用的连接
		- 交替传送请求和响应报文（实验阶段）。


##### 并行连接

##### 持久连接

##### 管道化连接


# HTTP结构


# 