[toc]



# 本周工作进展

1. 通过研究底层的because-why-not的开源代码，对于because-why-not的webrtc传输custom videoFrame的具体实现方式有了进一步的了解。由于because-why-not直接将他们开发过程中的源码提供给了我们，并且代码其实是正在开发和不完善的，有的Enum中声明的传输方式可能还没有实现；经测试发现，目前because-why-not中只有I420p和ARGB两种方式是可以使用的，别的内置的传输方式YUV2 ，Native等都还尚不能用。

2. 将MR原先的双方基于I420p传输custom videoFrame，改为：讲解者端->参观者端的人体rgbd数据使用I420p传输，参观者端->讲解者端的截屏RGB24数据使用ARGB来传输。原先使用I420p传输参观者->讲解者端的数据有2个问题：(1)I420p只能传输1920 1080 1.5Bytes的数据现在改为ARGB后能最大传输1920 1080 4Bytes 解决了使用I420p传输截屏数据还要在外部先进行一次YUV有损压缩的繁琐 (2)改善了原先使用I420p传输的帧率低，噪点大的问题。原来的双方对称传输(传输的内容一样、使用的传输方式也一样都是I420p)改为两端不对称传输。

3. 解决了MR系统内展示内容(ppt model video)不同步的问题。
	- 问题描述：
		- 原先版本中在两端处于正常连接状态时，此时对于展示内容的操控是会正常同步到对端的，但是如果其中一端点击了“关闭”按钮 or 直接退出程序，此时还未退出的那一端的内容会强制无法再使用键盘等输入设备进行操控并且会保持不变(如：如果其中一端退出连接时此端正在播放video，那么video便会不停的循环播放并且无法控关闭)。
	- 解决方式：
		- 通过双端强制复位来强制同步。无论哪一端点击了“关闭”按钮 or 退出程序，一旦双方的connectioned == true状态被破坏，双端立马进行内容复位到程序刚加载时内容的状态，并且在双端连接建立之前不能对内容进行操控，这样就保证了双端的内容connection == true 和 connection == false阶段时均是同步的。

# 下周工作计划
1. 研究Unity的图形渲染管线系统。因为后续的开发仍基于Unity且涉及大量的数据渲染操作，如果能深入了解Unity的内部渲染机理，就可以在渲染阶段层面进行优化
2. 研究Webrtc的传输机制



# 问题&&解决